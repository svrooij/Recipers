{
  "$schema": "https://demotime.show/demo-time.schema.json",
  "title": "Cloud Identity Summit",
  "description": "Hack your API for integration testing at the Cloud Identity Summit.",
  "version": 2,
  "demos": [
    {
      "title": "üßë‚Äçüè´ Intro",
      "description": "Starting slides",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/cis2025/slide-intro.md"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüè´ JWT Authentication",
      "description": "Explaning JWT Authentication (in dotnet)",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/jwt.md"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª Program.cs",
      "description": "Show how JWT Authentication is configured in the Program.cs file",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/Program.cs"
          }
        },
        {
          "action": "highlight",
          "path": "src/Recipers.Api/Program.cs",
          "startPlaceholder": "// ------------------- Authentication and Authorization -------------------",
          "endPlaceholder": "// ------------------- End Authentication and Authorization -------------------"
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª appsettings.json",
      "description": "Show how JWT Authentication is configured in the appsettings.json file",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/appsettings.json"
          }
        },
        {
          "action": "highlight",
          "path": "src/Recipers.Api/appsettings.json",
          "position": "9:17",
          "highlightWholeLine": true
        }
      ]
    },
    {
      "id": "demo-mdruswqm-luy4",
      "title": "üßë‚Äçüíª Show API",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/Program.cs"
          }
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.debug.start"
        }
      ],
      "description": "Start the API and show what we are talking about. This will start the process and launch an external browser"
    },
    {
      "title": "üßë‚Äçüè´ Test failures ‚ùå",
      "description": "Use automation to test for human error. Forgetting `.RequireAuthentication()` on a single endpoint is easy.",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/require-auth.md"
          }
        }
      ],
      "id": "demo-mdrv738n-8trd"
    },
    {
      "title": "üßë‚Äçüíª 401 on all endpoints",
      "description": "Load OpenAPI spec, send request to all endpoints, expect 401",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.Tests/MinimalApiEndpointsValidator.cs"
          }
        },
        {
          "action": "highlight",
          "path": "tests/Recipers.Api.Tests/MinimalApiEndpointsValidator.cs",
          "highlightWholeLine": true,
          "startPlaceholder": "// ------------------------- Authentication Tests -------------------------",
          "endPlaceholder": "// ------------------------- End Authentication Tests ---------------------"
        },
        {
          "action": "waitForInput"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "testing.debugCurrentFile"
        }
      ],
      "id": "demo-mdrvve1i-zfqp"
    },
    {
      "title": "üßë‚Äçüè´ Inject signing keys",
      "description": "How are we going to trick the api into trusting our fake tokens?",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/identity-proxy.md"
          }
        }
      ],
      "id": "demo-mdrxfed2-702q"
    },
    {
      "title": "üßë‚Äçüíª IWebApiFactory",
      "description": "Automatically start IdentityProxy and configure the api to use it",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.Tests/Helpers/RecipeApiFactoryWithIdentityProxy.cs"
          }
        }
      ],
      "id": "demo-mdrxi4me-u5rd"
    },
    {
      "title": "üßë‚Äçüíª Recipe tests",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.Tests/ControllerTests/RecipeTests.cs"
          }
        },
        {
          "action": "highlight",
          "path": "tests/Recipers.Api.Tests/ControllerTests/RecipeTests.cs",
          "startPlaceholder": "// Arrange: Get a valid token",
          "endPlaceholder": "token.Should().NotBeNull();"
        },
        {
          "action": "waitForInput"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "testing.debugCurrentFile"
        }
      ],
      "id": "demo-mdsth03z-3oh0",
      "description": "Get a token and actually execute the endpoint with authentication enabled"
    },
    {
      "title": "üßë‚Äçüè´ Protect against MitM",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/protect-against-mitm.md"
          }
        }
      ],
      "id": "demo-mdsrrag4-ebxq",
      "description": "Easily protect yourself against these sorts off attackts"
    },
    {
      "title": "üßë‚Äçüè´ Outro",
      "description": "What did we learn, thank you sponsors, ask me anything at 16:30, please leave feedback",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/cis2025/slides-end.md"
          }
        }
      ]
    },
    {
      "title": "üèÅ Reset VS Code",
      "description": "Return the editor theme to its default state to clean up after the demo.",
      "steps": [
        {
          "action": "unsetTheme"
        },
        {
          "action": "setSetting",
          "setting": {
            "key": "workbench.statusBar.visible",
            "value": true
          }
        },
        {
          "action": "setSetting",
          "setting": {
            "key": "workbench.activityBar.location",
            "value": "default"
          }
        }
      ]
    }
  ]
}