{
  "$schema": "https://demotime.show/demo-time.schema.json",
  "title": "Cloud Tech Tallinn",
  "description": "Impersonate Entra ID to truely test your api",
  "version": 2,
  "demos": [
    {
      "title": "üßë‚Äçüè´ Intro",
      "description": "Starting slides",
      "icons": {
        "start": "device-desktop"
      },
      "steps": [
        {
          "action": "executeTerminalCommand",
          "command": "start  \"C:\\Program Files\\Docker\\Docker\\Docker Desktop.exe\"",
          "terminalId": "docker"
        },
        {
          "action": "closeTerminal",
          "terminalId": "docker"
        },
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/ctt2026/slide-intro.md"
          }
        }
      ]
    },
    {
      "title": "üôã Session time",
      "steps": [
        {
          "action": "startEngageTimeSession"
        },
        {
          "action": "showEngageTimeSession"
        }
      ],
      "icons": {
        "start": "feedback",
        "end": ""
      },
      "description": "An interactive session with some polls during the presentation, please join in"
    },
    {
      "title": "‚ùìQuestion 1",
      "steps": [
        {
          "action": "showEngageTimePoll",
          "startOnOpen": true,
          "pollId": "vrjjqu"
        },
        {
          "action": "waitForInput",
          "message": "Show results?"
        },
        {
          "action": "closeEngageTimePoll",
          "pollId": "vrjjqu"
        }
      ],
      "icons": {
        "start": "question",
        "end": ""
      },
      "description": "How much do you know about API Security in dotnet?"
    },
    {
      "title": "üßë‚Äçüè´ JWT Authentication",
      "description": "Explaning JWT Authentication (in dotnet)",
      "icons": {
        "start": "mortar-board"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/jwt.md"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª Program.cs",
      "description": "Show how JWT Authentication is configured in the Program.cs file",
      "icons": {
        "start": "code"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/Program.cs"
          }
        },
        {
          "action": "highlight",
          "path": "src/Recipers.Api/Program.cs",
          "startPlaceholder": "// ------------------- Authentication and Authorization -------------------",
          "endPlaceholder": "// ------------------- End Authentication and Authorization -------------------"
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª appsettings.json",
      "description": "Show how JWT Authentication is configured in the appsettings.json file",
      "icons": {
        "start": "code"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/appsettings.json"
          }
        },
        {
          "action": "highlight",
          "path": "src/Recipers.Api/appsettings.json",
          "position": "9:17",
          "highlightWholeLine": true
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª Show API",
      "icons": {
        "start": "run-all"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/Program.cs"
          }
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.debug.start"
        }
      ],
      "description": "Start the API and show what we are talking about. This will start the process and launch an external browser"
    },
    {
      "title": "‚ùìQuestion 2",
      "steps": [
        {
          "action": "showEngageTimePoll",
          "startOnOpen": true,
          "pollId": "e45azn"
        },
        {
          "action": "waitForInput",
          "message": "Show results?"
        },
        {
          "action": "closeEngageTimePoll",
          "pollId": "e45azn"
        }
      ],
      "icons": {
        "start": "question",
        "end": ""
      },
      "description": "What is needed in Entra ID?"
    },
    {
      "title": "üßë‚Äçüè´ Test failures ‚ùå",
      "description": "Use automation to test for human error. Forgetting `.RequireAuthentication()` on a single endpoint is easy.",
      "icons": {
        "start": "device-desktop"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/require-auth.md"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª 401 on all endpoints",
      "description": "Load OpenAPI spec, send request to all endpoints, expect 401",
      "icons": {
        "start": "microscope"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.TUnitTests/MinimalApiEndpointsValidator.cs"
          }
        },
        {
          "action": "highlight",
          "path": "tests/Recipers.Api.TUnitTests/MinimalApiEndpointsValidator.cs",
          "highlightWholeLine": true,
          "startPlaceholder": "// ------------------------- Authentication Tests -------------------------",
          "endPlaceholder": "// ------------------------- End Authentication Tests ---------------------"
        },
        {
          "action": "waitForInput",
          "message": "Run authentication tests?"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "testing.debugCurrentFile"
        }
      ]
    },
    {
      "title": "‚ùìQuestion 3",
      "steps": [
        {
          "action": "showEngageTimePoll",
          "startOnOpen": true,
          "pollId": "3rtikv"
        },
        {
          "action": "waitForTimeout",
          "timeout": 60000
        },
        {
          "action": "closeEngageTimePoll",
          "pollId": "3rtikv"
        }
      ],
      "icons": {
        "start": "question",
        "end": ""
      },
      "description": "What error code for other users' data?"
    },
    {
      "title": "üßë‚Äçüè´ Inject signing keys",
      "icons": {
        "start": "light-bulb"
      },
      "description": "How are we going to trick the api into trusting our fake tokens?",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/identity-proxy.md"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª IWebApiFactory",
      "description": "Automatically start IdentityProxy and configure the api to use it",
      "icons": {
        "start": "code"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.Tests.Helpers/RecipeApiFactoryWithIdentityProxy.cs"
          }
        }
      ]
    },
    {
      "title": "üßë‚Äçüíª Recipe tests",
      "icons": {
        "start": "microscope"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "tests/Recipers.Api.TUnitTests/ControllerTests/RecipeTests.cs"
          }
        },
        {
          "action": "highlight",
          "path": "tests/Recipers.Api.TUnitTests/ControllerTests/RecipeTests.cs",
          "startPlaceholder": "// Arrange: Get a valid token",
          "endPlaceholder": "token.Should().NotBeNull();"
        },
        {
          "action": "waitForInput",
          "message": "Want to debug the Recipe tests?"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "testing.debugCurrentFile"
        }
      ],
      "description": "Get a token and actually execute the endpoint with authentication enabled"
    },
    {
      "title": "üßë‚Äçüè´ Protect against MitM",
      "icons": {
        "start": "shield"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/protect-against-mitm.md"
          }
        }
      ],
      "description": "Easily protect yourself against these sorts off attackts"
    },
    {
      "title": "üßë‚Äçüíª 404 vs 401",
      "icons": {
        "start": "alert"
      },
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-code.json",
          "args": {
            "FILE_PATH": "src/Recipers.Api/Program.cs"
          }
        },
        {
          "action": "highlight",
          "path": "src/Recipers.Api/Program.cs",
          "startPlaceholder": "// Unauthenticated users",
          "endPlaceholder": "// End of fallback mapping"
        }
      ],
      "description": "Should unauthenticated requests get 404 or 401?"
    },
    {
      "title": "‚ùìQuestion 4",
      "steps": [
        {
          "action": "showEngageTimePoll",
          "startOnOpen": true,
          "pollId": "ei30oc"
        },
        {
          "action": "waitForInput",
          "message": "Show results?"
        },
        {
          "action": "closeEngageTimePoll",
          "pollId": "ei30oc"
        }
      ],
      "icons": {
        "start": "question",
        "end": ""
      },
      "description": "Will you be using identity proxy for your next project?"
    },
    {
      "title": "üßë‚Äçüè´ Outro",
      "icons": {
        "start": "device-desktop"
      },
      "description": "Please leave feedback",
      "steps": [
        {
          "action": "snippet",
          "contentPath": ".demo/.snippets/show-slide.json",
          "args": {
            "SLIDES_FILE": ".demo/slides/ctt2026/slides-end.md"
          }
        }
      ]
    },
    {
      "title": "üèÅ Reset VS Code",
      "icons": {
        "start": "wrench"
      },
      "description": "Return the editor theme to its default state to clean up after the demo.",
      "steps": [
        {
          "action": "unsetTheme"
        },
        {
          "action": "setSetting",
          "setting": {
            "key": "window.zoomLevel",
            "value": 1
          }
        },
        {
          "action": "setSetting",
          "setting": {
            "key": "workbench.statusBar.visible",
            "value": true
          }
        },
        {
          "action": "setSetting",
          "setting": {
            "key": "workbench.activityBar.location",
            "value": "default"
          }
        }
      ]
    }
  ],
  "engageTime": {
    "sessionId": "mfvuwp"
  }
}